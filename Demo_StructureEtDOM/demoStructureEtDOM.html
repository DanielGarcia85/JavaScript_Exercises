<select id="produits">
    <option></option>
    <option>Banane</option>
    <option>Fraise</option>
    <option>Kaki</option>
</select>

<input placeholder="quantite" id="quantite"/>
<button id="btnAjouter">Ajouter</button>
<br>
<button id="btnSupprimerDernier">Supprimer dernier</button>
<button id="demo">Demo</button>
<ul id="listeAffichee"></ul>
<script>
    // Panier
    let panier = []
    btnAjouter.addEventListener('click', ()=>{
        let nouveauProduit = panier.find((p)=>p.nom==produits.value)
        if (!nouveauProduit) {
            nouveauProduit = {
                nom: produits.value,
                qte: Number(quantite.value)            
            }
            panier.push(nouveauProduit)        
            panier.sort((p1, p2)=>p1.nom.localeCompare(p2.nom))
        } else {
            nouveauProduit.qte += Number(quantite.value)
        }
        afficherPanier()
        console.log(panier)
    } )

    btnSupprimerDernier.addEventListener('click', ()=>listeAffichee.lastChild.remove())

    listeAffichee.addEventListener('click', (evenement)=>{
        if (evenement.target.nodeName=='LI') {            
            console.log(evenement.target.dataset.nom)
            panier = panier.filter((p)=>p.nom!=evenement.target.dataset.nom)
            afficherPanier();
            //evenement.target.remove()
        }
    })
    demo.addEventListener('click', (evenement)=>console.log(evenement))

    function afficherPanier() {
        // Afficher dans la page
        // Supprimer le contenu de liste UL
        while (listeAffichee.hasChildNodes()) {
            listeAffichee.removeChild(listeAffichee.firstChild)
            //listeAffichee.firstChild.remove()
        }
        panier.forEach((p)=>{
            // Créer un LI
            let li = document.createElement('li')     
            // Ajouter l'identifiant (nom) au li
            li.setAttribute('data-nom', p.nom)

            // Créer le text
            let texte = document.createTextNode(`${p.nom} ${p.qte}`)
            // Ajouter le texte
            li.appendChild(texte)
            // Ajouter le LI au UL
            listeAffichee.appendChild(li)
        })

    }
</script>