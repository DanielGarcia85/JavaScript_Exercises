<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='UTF-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1.0'>
        <title>TP-7 Stockage Corrigé</title>
    </head>
<h1>TP 7 - Corrigé</h1>
<h2>Exercice 1</h2>
Heure: <span id="heure"></span>
<hr>
<h2>Exercice 2</h2>
<ul id="liste"><li>Bleu</li><li>Jaune</li><li>Orange</li><li>Vert</li><li>Violet</li></ul>
<hr>
<h2>Exercice 3</h2>
<div id="vignettes">
    <img class="vignette" src="TP_07_images/chocolat1.jpeg" width="100px"/>
    <img class="vignette" src="TP_07_images/chocolat2.jpeg" width="100px"/>
    <img class="vignette" src="TP_07_images/chocolat3.jpeg" width="100px"/>
    <img class="vignette" src="TP_07_images/chocolat4.jpeg" width="100px"/>    
</div>
<br>
<br>
<a href="#" id="arreter">Arrêter</a>
<a href="#" id="lancer">Lancer</a>
<a href="#" id="ralentir">Ralentir</a>
<a href="#" id="accelerer">Accélérer</a>
<br>
<img id="image" src="TP_07_images/chocolat1.jpeg" width="300px" />

<script>
    // Exercice 1
    setInterval(_=>{
        const d = new Date();
        heure.innerHTML = d.toLocaleTimeString();
    }, 1000)

    // Exercice 2
    // Enregistrer un déclenchement dans 5 secondes
    setTimeout(_=>{
        // Enregistrer un intervale
        let tm = setInterval(_=>{
            liste.removeChild(liste.lastChild);
            // Supprimer l'intervale si la liste n'a plus d'élément:
            if (!liste.hasChildNodes()) {
                clearInterval(tm);
            }
        }, 1000);

    }, 5000)

    // Exercice 3
    let delai = 2000;
    let imageActuelle = 0;
    let opacite = 1
    let image = document.getElementById('image');
    tmImages = setInterval(diaporama, delai);

    function diaporama() {
        // Liste des vignettes:
        const listeVignettes = document.getElementsByClassName('vignette');
        // Indice de la prochaine image (++ avec modulo le nombre de vignettes)
        imageActuelle = (++imageActuelle) % listeVignettes.length;
        // Modifier la source de l'image
        image.src = listeVignettes[imageActuelle].src;
    }

    arreter.addEventListener('click', evenement=>{
        // Annuler l'événement pour empêcher le rechargement de la page
        evenement.preventDefault();
        // Supprimer l'intervale
        clearInterval(tmImages);
    })

    lancer.addEventListener('click', evenement=>{
        // Annuler l'événement pour empêcher le rechargement de la page
        evenement.preventDefault();
        // Supprimer l'intervale pour éviter d'en avoir plusieurs!
        clearInterval(tmImages);
        tmImages = setInterval(diaporama, delai);
    })

    ralentir.addEventListener('click', evenement=>{
        // Annuler l'événement pour empêcher le rechargement de la page
        evenement.preventDefault();
        // Modifier le délai
        delai *= 2;
        // Supprimer l'intervale et le relancer avec le nouveau délai
        clearInterval(tmImages);
        tmImages = setInterval(diaporama, delai);
    })

    accelerer.addEventListener('click', evenement=>{
        // Annuler l'événement pour empêcher le rechargement de la page
        evenement.preventDefault();
        // Modifier le délai
        delai /= 2;
        // Supprimer l'intervale et le relancer avec le nouveau délai
        clearInterval(tmImages);
        tmImages = setInterval(diaporama, delai);
    })

</script>