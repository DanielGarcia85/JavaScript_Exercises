<canvas id="monCanvas" width="300px"  height="300px"/>

<script>

const ctx = monCanvas.getContext("2d");
const formes = [];

// Création des formes aléatoirs
for (i=0; i<500; i++) {
  formes.push(nouvelleForme());
}

// Lancement de l'animation
setInterval(_=>{
  ctx.clearRect(0,0,300,300);
  formes.forEach(f=>{
    f = deplacer(f);
    dessiner(f)
  })
}, 30)

function nombreAleatoire(min, max, arrondir=true) {
  let nombre = min+Math.random()*(max-min);
  if (arrondir) return Math.floor(nombre);
  return nombre;
}

function nouvelleForme() {
  const f = {};
  f.forme = nombreAleatoire(1, 4); // 1: rectangle, 2: rond, 3: triangle
  f.hauteur = nombreAleatoire(5,15);
  f.largeur = nombreAleatoire(5,15);
  f.x = nombreAleatoire(0, 300);
  f.y = nombreAleatoire(0, 300);
  f.vitesse = nombreAleatoire(1, 5);
  f.sens = Math.random()<0.5 ? 1 : -1;
  f.couleur = `rgba(${nombreAleatoire(0, 255)}, ${nombreAleatoire(0, 255)}, ${nombreAleatoire(0, 255)}, ${nombreAleatoire(0.4, 1, false)})`;
  return f;
}

function deplacer(f) {
  f.x += f.vitesse*f.sens;
  if (f.x > 300) f.sens *= -1;
  if (f.x<0) f.sens *= -1;
  return f;
}
    
function dessiner(f) {
  ctx.fillStyle = f.couleur;
  switch (f.forme) {
    case 1:
      ctx.fillRect(f.x, f.y, f.largeur, f.hauteur);
      ctx.strokeRect(f.x, f.y, f.largeur, f.hauteur);
      break;
    case 2:
      ctx.beginPath();
      ctx.arc(f.x, f.y, f.hauteur, 0, 2*Math.PI);
      ctx.fill();
      ctx.stroke();
      ctx.closePath();
      break;
    case 3:
      ctx.beginPath();
      ctx.moveTo(f.x, f.y);
      ctx.lineTo(f.x+f.largeur/2, f.y+f.hauteur);
      ctx.lineTo(f.x-f.largeur/2, f.y+f.hauteur);
      ctx.lineTo(f.x, f.y);
      ctx.fill();
      ctx.stroke();
      ctx.closePath();
      break;
  }
}
    
</script>
